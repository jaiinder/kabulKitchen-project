"use strict";define("contactForm",["lodash","santaProps","utils","formCommon","reactDOM"],function(e,r,t,i,n){function s(){var e=this.state.notifications;return{notifications:{className:this.classSet({error:e.error,success:!e.error}),children:[e.message]}}}function a(r,i,n){var s=t.validationUtils;return!(!r.hidden&&r.required)||(i===f.call(this)?s.isValidEmail(n):!e.isEmpty(n))}function d(e,r,t,i){return i?l(e,r,t):u.call(this,r,e[r])}function o(r){return e.reduce(e.keys(r),function(e,r){return"notification"===r?e:e&&r},!0)}function l(r,t,i){var n={},s=r[t];return s&&s.error&&(n[t]={error:!0},o(r)&&(n.notifications={error:!1,message:""})),n[t]=e.assign(n[t]||{},{hidden:s.hidden,required:s.required,value:i}),n}function u(e,r){var t={};return t[e]={error:!0,hidden:r.hidden,required:r.required,value:r.value},t.notifications={message:e===f.call(this)?this.props.errorMessage:this.props.validationErrorMessage,error:!0},t}function c(r){var t=r.target.id.replace(this.props.id,"").replace("Field","").toLowerCase();this.setState(e.assign(this.state[t],{error:!1}))}function p(r){var t=r.target.id.replace(this.props.id,"").replace("Field","").toLowerCase();this.setState(e.assign(this.state[t],{value:r.target.value}))}function h(r){return e.reduce(r,function(e,r){var t=!r.hidden,i=g(r);return e["$"+i]=t?i+"Hidden":"",e},{})}function f(){return g(e.find(this.props.orderedFields,{fieldType:"email"}))}function v(){return this.state[f.call(this)]}function m(){var r=e.find(this.props.orderedFields,{fieldType:"name"});return this.state[g(r)]}function g(e){return"field"+(e.index+1)}function F(e){return"label_field"+(e.index+1)}function y(r,t){var i=this.state[r],n={required:!!t.required,hidden:!t.hidden};return e.merge(i,n),{name:t.fieldLabel,value:i.value,className:this.classSet(i),placeholder:t.fieldLabel,onChange:p.bind(this),onClick:c.bind(this),"data-aid":t.fieldType+"Field"}}function T(){var r=this;return this.props.orderedFields.reduce(function(t,i){var n=g(i),s=y.call(r,n,i),a=e.set({},n,s);return e.assign(t,a)},{})}function S(){var r=this;return this.props.orderedFields.reduce(function(t,i){var n=!i.hidden,s=e.set({},F(i),{className:r.classSet({hidden:n}),children:[i.fieldLabel],"data-aid":"label_"+i.fieldType});return e.assign(t,s)},{})}return{displayName:"ContactForm",mixins:[i.formMixin],propTypes:{orderedFields:r.Types.ContactFormSantaTypes.orderedFields.isRequired,errorMessage:r.Types.ContactFormSantaTypes.errorMessage.isRequired,validationErrorMessage:r.Types.ContactFormSantaTypes.validationErrorMessage.isRequired,isExperimentOpen:r.Types.isExperimentOpen},statics:{useSantaTypes:!0},componentWillReceiveProps:function(r){var t=h(this.props.orderedFields),i=h(r.orderedFields);e.isEqual(t,i)||this.setState(i)},getFormInitialState:function(){var r={mailSent:!1,notifications:{error:!1,message:"",hidden:!0,required:!1}},t=this.props.orderedFields.reduce(function(e,r){return e[g(r)]={error:!1,hidden:!r.hidden,required:!!r.required},e},r),i=h(this.props.orderedFields);return e.merge(t,i)},getCleanFormState:function(){return e.reduce(this.props.orderedFields,function(e,r){var t=g(r);return e[t]=e[t]||{},e[t].value="",e},{})},getActivityName:function(){return"ContactFormActivity"},getFormFields:function(){var r=this,t=e.reduce(this.props.orderedFields,function(e,t){if(t.hidden){var i=t.fieldLabel,n=r.state[g(t)].value||"";e.displayed[i]=n,e.structured.push({type:t.fieldType,label:i,value:n})}return e},{displayed:{},structured:[]});return t.getAll=function(r){return e.filter(t.structured,{type:r})},{newModel:!0,data:t}},getFieldsForActivityReporting:function(){return e.reduce(this.props.orderedFields,function(e,r){return r.hidden&&(e[r.fieldType]=this.state[g(r)].value||""),e}.bind(this),{})},getFieldLabels:function(){return e(this.props.orderedFields).filter(function(r){return e.has(r,"fieldType")}).map(function(e){return{type:e.fieldType,label:e.fieldLabel}}).value()},isFormValid:function(){var r=this.state,t=e.clone(r),i=v.call(this),s=i.value,o=f.call(this),l=a.call(this,i,o,s);t=d.call(this,r,o,s,l);var u;return l&&(u=e.reduce(this.props.orderedFields,function(i,s){var o=g(s),l=n.findDOMNode(this.refs[o]).value,u=a.call(this,r[o],o.toLowerCase(),l);return t=e.assign(t,d.call(this,r,o,l,u)),i&&u}.bind(this),!0)),this.setState(t),u},getInputName:function(){var e=m.call(this).value;return this.props.isExperimentOpen("sendContactFormEmailsViaPong")?e||null:e||"n/a"},getLangKeys:function(e){return t.translations.contactFormTranslations[e]},getFormSkinProperties:function(){var r=T.call(this),t=S.call(this),i=s.call(this);return e.assign({},r,t,i)}}});
//# sourceMappingURL=contactForm.min.js.map